//
//  lsx_cipher_tables.h
//  lsx_cipher_attack
//
//  Created by Георгий Джаниашвили on 21/12/2021.
//  Copyright © 2021 Георгий Джаниашвили. All rights reserved.
//

#ifndef lsx_cipher_tables_h
#define lsx_cipher_tables_h

#include <stdio.h>

uint16_t numbers[16] = {0x0, 0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0xa, 0xb, 0xc, 0xd, 0xe, 0xf};

uint16_t gf16[16][16] = { //неприводимый x^4+x+1
    {0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0},
    {0x0, 0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0xa, 0xb, 0xc, 0xd, 0xe, 0xf},
    {0x0, 0x2, 0x4, 0x6, 0x8, 0xa, 0xc, 0xe, 0x3, 0x1, 0x7, 0x5, 0xb, 0x9, 0xf, 0xd},
    {0x0, 0x3, 0x6, 0x5, 0xc, 0xf, 0xa, 0x9, 0xb, 0x8, 0xd, 0xe, 0x7, 0x4, 0x1, 0x2},
    {0x0, 0x4, 0x8, 0xc, 0x3, 0x7, 0xb, 0xf, 0x6, 0x2, 0xe, 0xa, 0x5, 0x1, 0xd, 0x9},
    {0x0, 0x5, 0xa, 0xf, 0x7, 0x2, 0xd, 0x8, 0xe, 0xb, 0x4, 0x1, 0x9, 0xc, 0x3, 0x6},
    {0x0, 0x6, 0xc, 0xa, 0xb, 0xd, 0x7, 0x1, 0x5, 0x3, 0x9, 0xf, 0xe, 0x8, 0x2, 0x4},
    {0x0, 0x7, 0xe, 0x9, 0xf, 0x8, 0x1, 0x6, 0xd, 0xa, 0x3, 0x4, 0x2, 0x5, 0xc, 0xb},
    {0x0, 0x8, 0x3, 0xb, 0x6, 0xe, 0x5, 0xd, 0xc, 0x4, 0xf, 0x7, 0xa, 0x2, 0x9, 0x1},
    {0x0, 0x9, 0x1, 0x8, 0x2, 0xb, 0x3, 0xa, 0x4, 0xd, 0x5, 0xc, 0x6, 0xf, 0x7, 0xe},
    {0x0, 0xa, 0x7, 0xd, 0xe, 0x4, 0x9, 0x3, 0xf, 0x5, 0x8, 0x2, 0x1, 0xb, 0x6, 0xc},
    {0x0, 0xb, 0x5, 0xe, 0xa, 0x1, 0xf, 0x4, 0x7, 0xc, 0x2, 0x9, 0xd, 0x6, 0x8, 0x3},
    {0x0, 0xc, 0xb, 0x7, 0x5, 0x9, 0xe, 0x2, 0xa, 0x6, 0x1, 0xd, 0xf, 0x3, 0x4, 0x8},
    {0x0, 0xd, 0x9, 0x4, 0x1, 0xc, 0x8, 0x5, 0x2, 0xf, 0xb, 0x6, 0x3, 0xe, 0xa, 0x7},
    {0x0, 0xe, 0xf, 0x1, 0xd, 0x3, 0x2, 0xc, 0x9, 0x7, 0x6, 0x8, 0x4, 0xa, 0xb, 0x5},
    {0x0, 0xf, 0xd, 0x2, 0x9, 0x6, 0x4, 0xb, 0x1, 0xe, 0xc, 0x3, 0x8, 0x7, 0x5, 0xa}
};

std::vector<int> LSX_cipher::s_box = {0x2, 0xd, 0x7, 0x1, 0xf, 0x8, 0xb, 0x6, 0x4, 0x9, 0xc, 0x5, 0x0, 0xa, 0xe, 0x3};

std::vector<int> LSX_cipher::s_box_inv = {0xc, 0x3, 0x0, 0xf, 0x8, 0xb, 0x7, 0x2, 0x5, 0x9, 0xd, 0x6, 0xa, 0x1, 0xe, 0x4};

std::vector<std::vector<int>> LSX_cipher::key_list{
    {0x1, 0x1, 0xf, 0x1, 0x8},
    {0x4, 0x0, 0xe, 0x8, 0xd},
    {0x1, 0x8, 0xf, 0x4, 0xb}
};

std::vector<std::vector<int>> LSX_cipher::l_table{
    {0xa, 0x4, 0x8, 0x5, 0x9},
    {0xd, 0x4, 0xa, 0xd, 0x5},
    {0x7, 0x5, 0x9, 0x1, 0x5},
    {0x6, 0x6, 0x6, 0x8, 0xf},
    {0x2, 0xb, 0x3, 0x7, 0x7}
};

std::vector<std::vector<int>> LSX_cipher::l_table_inv{
    {0xa, 0x9, 0xd, 0xb, 0x6},
    {0x4, 0x8, 0xe, 0xb, 0xe},
    {0x6, 0xf, 0x3, 0xa, 0x7},
    {0x9, 0x6, 0xa, 0xe, 0x6},
    {0x8, 0xd, 0x1, 0x8, 0x8}
};

#endif /* lsx_cipher_tables_h */
